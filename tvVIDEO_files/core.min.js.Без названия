var $document=$(document),$window=$(window),$body=$("body"),DATA_DISPLAYCONTROLLER="displayController",DATA_HASACTIVEHOVER="hasActiveHover",DATA_FORCEDOPEN="forcedOpen",DATA_HASMOUSEMOVE="hasMouseMove",DATA_MOUSEONTOTIP="mouseOnToPopup",DATA_ORIGINALTITLE="originalTitle",DATA_POWERTIP="powertip",DATA_POWERTIPJQ="powertipjq",DATA_POWERTIPTARGET="powertiptarget",EVENT_NAMESPACE=".powertip",RAD2DEG=180/Math.PI,session={elements:null,tooltips:null,isTipOpen:!1,isFixedTipOpen:!1,isClosing:!1,tipOpenImminent:!1,activeHover:null,currentX:0,currentY:0,previousX:0,previousY:0,desyncTimeout:null,closeDelayTimeout:null,mouseTrackingActive:!1,delayInProgress:!1,windowWidth:0,windowHeight:0,scrollTop:0,scrollLeft:0},Collision={none:0,top:1,bottom:2,left:4,right:8};$.fn.powerTip=function(e,s){var n,t,o=this;return o.length?"string"===$.type(e)&&$.powerTip[e]?$.powerTip[e].call(o,o,s):(n=$.extend({},$.fn.powerTip.defaults,e),t=new TooltipController(n),initTracking(),o.each(function(){var e,s=$(this),o=s.data(DATA_POWERTIP),i=s.data(DATA_POWERTIPJQ),T=s.data(DATA_POWERTIPTARGET);s.data(DATA_DISPLAYCONTROLLER)&&$.powerTip.destroy(s),e=s.attr("title"),o||T||i||!e||(s.data(DATA_POWERTIP,e),s.data(DATA_ORIGINALTITLE,e),s.removeAttr("title")),s.data(DATA_DISPLAYCONTROLLER,new DisplayController(s,n,t))}),n.manual||($.each(n.openEvents,function(e,s){$.inArray(s,n.closeEvents)>-1?o.on(s+EVENT_NAMESPACE,function(e){$.powerTip.toggle(this,e)}):o.on(s+EVENT_NAMESPACE,function(e){$.powerTip.show(this,e)})}),$.each(n.closeEvents,function(e,s){$.inArray(s,n.openEvents)<0&&o.on(s+EVENT_NAMESPACE,function(e){$.powerTip.hide(this,!isMouseEvent(e))})}),o.on("keydown"+EVENT_NAMESPACE,function(e){27===e.keyCode&&$.powerTip.hide(this,!0)})),session.elements=session.elements?session.elements.add(o):o,o):o},$.fn.powerTip.defaults={fadeInTime:200,fadeOutTime:100,followMouse:!1,popupId:"powerTip",popupClass:null,intentSensitivity:7,intentPollInterval:100,closeDelay:100,placement:"n",smartPlacement:!1,offset:10,mouseOnToPopup:!1,manual:!1,openEvents:["mouseenter","focus"],closeEvents:["mouseleave","blur"]},$.fn.powerTip.smartPlacementLists={n:["n","ne","nw","s"],e:["e","ne","se","w","nw","sw","n","s","e"],s:["s","se","sw","n"],w:["w","nw","sw","e","ne","se","n","s","w"],nw:["nw","w","sw","n","s","se","nw"],ne:["ne","e","se","n","s","sw","ne"],sw:["sw","w","nw","s","n","ne","sw"],se:["se","e","ne","s","n","nw","se"],"nw-alt":["nw-alt","n","ne-alt","sw-alt","s","se-alt","w","e"],"ne-alt":["ne-alt","n","nw-alt","se-alt","s","sw-alt","e","w"],"sw-alt":["sw-alt","s","se-alt","nw-alt","n","ne-alt","w","e"],"se-alt":["se-alt","s","sw-alt","ne-alt","n","nw-alt","e","w"]},$.powerTip={show:function(e,s){return isMouseEvent(s)?(trackMouse(s),session.previousX=s.pageX,session.previousY=s.pageY,$(e).data(DATA_DISPLAYCONTROLLER).show()):$(e).first().data(DATA_DISPLAYCONTROLLER).show(!0,!0),e},reposition:function(e){return $(e).first().data(DATA_DISPLAYCONTROLLER).resetPosition(),e},hide:function(e,s){var n;return s=e?s:!0,e?n=$(e).first().data(DATA_DISPLAYCONTROLLER):session.activeHover&&(n=session.activeHover.data(DATA_DISPLAYCONTROLLER)),n&&n.hide(s),e},toggle:function(e,s){return session.activeHover&&session.activeHover.is(e)?$.powerTip.hide(e,!isMouseEvent(s)):$.powerTip.show(e,s),e},destroy:function(e){var s=e?$(e):session.elements;return session.elements&&0!==session.elements.length?(s.off(EVENT_NAMESPACE).each(function(){var e=$(this),s=[DATA_ORIGINALTITLE,DATA_DISPLAYCONTROLLER,DATA_HASACTIVEHOVER,DATA_FORCEDOPEN];e.data(DATA_ORIGINALTITLE)&&(e.attr("title",e.data(DATA_ORIGINALTITLE)),s.push(DATA_POWERTIP)),e.removeData(s)}),session.elements=session.elements.not(s),0===session.elements.length&&($window.off(EVENT_NAMESPACE),$document.off(EVENT_NAMESPACE),session.mouseTrackingActive=!1,session.tooltips.remove(),session.tooltips=null),e):e}},$.powerTip.showTip=$.powerTip.show,$.powerTip.closeTip=$.powerTip.hide;