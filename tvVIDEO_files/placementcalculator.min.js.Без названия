function PlacementCalculator(){function t(t,o,a,i,n){var r,l=o.split("-")[0],f=new CSSCoordinates;switch(r=isSvgElement(t)?s(t,l):e(t,l),o){case"n":f.set("left",r.left-a/2),f.set("bottom",session.windowHeight-r.top+n);break;case"e":f.set("left",r.left+n),f.set("top",r.top-i/2);break;case"s":f.set("left",r.left-a/2),f.set("top",r.top+n);break;case"w":f.set("top",r.top-i/2),f.set("right",session.windowWidth-r.left+n);break;case"nw":f.set("bottom",session.windowHeight-r.top+n),f.set("right",session.windowWidth-r.left-20);break;case"nw-alt":f.set("left",r.left),f.set("bottom",session.windowHeight-r.top+n);break;case"ne":f.set("left",r.left-20),f.set("bottom",session.windowHeight-r.top+n);break;case"ne-alt":f.set("bottom",session.windowHeight-r.top+n),f.set("right",session.windowWidth-r.left);break;case"sw":f.set("top",r.top+n),f.set("right",session.windowWidth-r.left-20);break;case"sw-alt":f.set("left",r.left),f.set("top",r.top+n);break;case"se":f.set("left",r.left-20),f.set("top",r.top+n);break;case"se-alt":f.set("top",r.top+n),f.set("right",session.windowWidth-r.left)}return f}function e(t,e){var s,o,a=t.offset(),i=t.outerWidth(),n=t.outerHeight();switch(e){case"n":s=a.left+i/2,o=a.top;break;case"e":s=a.left+i,o=a.top+n/2;break;case"s":s=a.left+i/2,o=a.top+n;break;case"w":s=a.left,o=a.top+n/2;break;case"nw":s=a.left,o=a.top;break;case"ne":s=a.left+i,o=a.top;break;case"sw":s=a.left,o=a.top+n;break;case"se":s=a.left+i,o=a.top+n}return{top:o,left:s}}function s(t,e){function s(){b.push(f.matrixTransform(w))}var o,a,i,n,r=t.closest("svg")[0],l=t[0],f=r.createSVGPoint(),c=l.getBBox(),w=l.getScreenCTM(),p=c.width/2,h=c.height/2,b=[],k=["nw","n","ne","e","se","s","sw","w"];if(f.x=c.x,f.y=c.y,s(),f.x+=p,s(),f.x+=p,s(),f.y+=h,s(),f.y+=h,s(),f.x-=p,s(),f.x-=p,s(),f.y-=h,s(),b[0].y!==b[1].y||b[0].x!==b[7].x)for(a=Math.atan2(w.b,w.a)*RAD2DEG,i=Math.ceil((a%360-22.5)/45),1>i&&(i+=8);i--;)k.push(k.shift());for(n=0;n<b.length;n++)if(k[n]===e){o=b[n];break}return{top:o.y+session.scrollTop,left:o.x+session.scrollLeft}}this.compute=t}